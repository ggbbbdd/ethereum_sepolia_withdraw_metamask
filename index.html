<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ethers.jsì™€ MetaMask ì—°ë™ (Sepolia)</title>
    <style>
        body { font-family: sans-serif; text-align: center; padding: 20px; background-color: #f4f4f9; color: #333; }
        h1 { color: #4a4a4a; }
        button { font-size: 16px; padding: 12px 24px; cursor: pointer; border: none; border-radius: 8px; background-color: #007bff; color: white; transition: background-color 0.3s; }
        button:hover { background-color: #0056b3; }
        #walletInfo { margin-top: 30px; padding: 20px; background-color: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); display: inline-block; min-width: 300px; }
        #walletInfo p { font-size: 16px; word-break: break-all; margin: 10px 0; }
        #walletInfo p#status { font-weight: bold; }
    </style>
</head>
<body>

    <h1>Ethers.jsë¡œ MetaMask ì§€ê°‘ ì—°ê²°í•˜ê¸°</h1>
    <p>MetaMask ë„¤íŠ¸ì›Œí¬ë¥¼ <strong>Sepolia</strong>ë¡œ ì„¤ì •í•´ì£¼ì„¸ìš”.</p>
    <button id="connectButton">ğŸ¦Š MetaMask ì§€ê°‘ ì—°ê²°</button>
    <div id="walletInfo">
        <p id="status">ì—°ê²°ì„ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘...</p>
        <p id="account"></p>
        <p id="balance"></p>
        <p id="chainId"></p>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.13.1/ethers.umd.min.js"></script>

    <script>
        const connectButton = document.getElementById('connectButton');
        const statusEl = document.getElementById('status');
        const accountEl = document.getElementById('account');
        const balanceEl = document.getElementById('balance');
        const chainIdEl = document.getElementById('chainId');

        async function connectWallet() {
            if (typeof window.ethereum !== 'undefined') {
                statusEl.textContent = "MetaMaskì— ì—°ê²°ì„ ìš”ì²­í•©ë‹ˆë‹¤...";
                try {
                    const provider = new ethers.BrowserProvider(window.ethereum);
                    await provider.send("eth_requestAccounts", []);
                    const signer = await provider.getSigner();
                    
                    const address = await signer.getAddress();
                    const balanceWei = await provider.getBalance(address);
                    const network = await provider.getNetwork();

                    // â­ ì”ì•¡ì„ ì†Œìˆ˜ì  6ìë¦¬ë¡œ í¬ë§·íŒ…í•˜ëŠ” ë¶€ë¶„
                    // 1. Wei ë‹¨ìœ„ë¥¼ ETH ë‹¨ìœ„ì˜ ë¬¸ìì—´ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.
                    const balanceEther = ethers.formatEther(balanceWei);
                    // 2. ë¬¸ìì—´ì„ ìˆ«ìë¡œ ë³€í™˜í•œ ë’¤, ì†Œìˆ˜ì  6ìë¦¬ê¹Œì§€ì˜ ë¬¸ìì—´ë¡œ í¬ë§·íŒ…í•©ë‹ˆë‹¤.
                    const formattedBalance = parseFloat(balanceEther).toFixed(6);

                    // í™”ë©´ì— ì •ë³´ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.
                    statusEl.textContent = "âœ… ì§€ê°‘ ì—°ê²° ì„±ê³µ!";
                    accountEl.textContent = `ì£¼ì†Œ: ${address}`;
                    // ìˆ˜ì •ëœ ì”ì•¡ ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
                    balanceEl.textContent = `ì”ì•¡: ${formattedBalance} ETH`;
                    chainIdEl.textContent = `ë„¤íŠ¸ì›Œí¬ ID: ${network.chainId} (${network.name})`;

                } catch (error) {
                    console.error(error);
                    statusEl.textContent = `âŒ ì—°ê²° ì‹¤íŒ¨: ${error.message}`;
                }
            } else {
                statusEl.textContent = "MetaMaskê°€ ì„¤ì¹˜ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤. ì„¤ì¹˜í•´ì£¼ì„¸ìš”!";
                alert("MetaMaskë¥¼ ì„¤ì¹˜í•´ì£¼ì„¸ìš”!");
            }
        }

        connectButton.addEventListener('click', connectWallet);
    </script>

</body>
</html>